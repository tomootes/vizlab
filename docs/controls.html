<!DOCTYPE html>

<html>
<head>
  <title>controls.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="OrbitalControls.html">
                  OrbitalControls.js
                </a>
              
                
                <a class="source" href="animate.html">
                  animate.js
                </a>
              
                
                <a class="source" href="animate_from_file.html">
                  animate_from_file.js
                </a>
              
                
                <a class="source" href="animate_from_socket.html">
                  animate_from_socket.js
                </a>
              
                
                <a class="source" href="animation.html">
                  animation.js
                </a>
              
                
                <a class="source" href="connection.html">
                  connection.js
                </a>
              
                
                <a class="source" href="controls.html">
                  controls.js
                </a>
              
                
                <a class="source" href="init.html">
                  init.js
                </a>
              
                
                <a class="source" href="marker.html">
                  marker.js
                </a>
              
                
                <a class="source" href="stats.html">
                  stats.js
                </a>
              
                
                <a class="source" href="tsv.html">
                  tsv.js
                </a>
              
                
                <a class="source" href="webgl-debug.html">
                  webgl-debug.js
                </a>
              
                
                <a class="source" href="websocket.html">
                  websocket.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>controls.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>Init the slider with id=”slider”
set the min, max, steps and functions for starting and stop to slide and</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initSlider</span><span class="hljs-params">()</span></span>{
  $(<span class="hljs-string">"#slider"</span>).slider({
    value:iteration,
    min: <span class="hljs-number">0</span>,
    max: (coordinates.length -<span class="hljs-number">2</span>),
    step: <span class="hljs-number">1</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>When slider starts to slide</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    slide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, ui)</span></span>{     
      paused = <span class="hljs-literal">true</span>;
      iteration = ui.value;
      controls.enabled = <span class="hljs-literal">false</span>;
    },
    stop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, ui)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>When slider stops to slide</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      paused = <span class="hljs-literal">false</span>;
      controls.enabled = <span class="hljs-literal">true</span>;
    }
  });
}</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Adjust the renderer when the screensize changes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onWindowResize</span><span class="hljs-params">()</span></span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Set new camera settings and update</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  camera.aspect = <span class="hljs-built_in">window</span>.innerWidth / <span class="hljs-built_in">window</span>.innerHeight;
  camera.updateProjectionMatrix();</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Set new webglRenderer settings which will be updated the new frame</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  webglRenderer.setSize(<span class="hljs-built_in">window</span>.innerWidth, <span class="hljs-built_in">window</span>.innerHeight);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Execute onWindowResize when the event ‘resize’ occures on object window</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'resize'</span>, onWindowResize, <span class="hljs-literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Delete connections if they are selected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteConnections</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;connections.length;i++){
    <span class="hljs-keyword">var</span> s = connections[i].isSelected();
    <span class="hljs-keyword">if</span>(s == <span class="hljs-literal">true</span>){
      connections[i].remove();
    } 
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Function for pausing the animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pauseAnimation</span><span class="hljs-params">()</span></span>{
  paused = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Change #play-icon elements’ classname to .glypicon-play to show the play icon when playing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"play-icon"</span>).className = <span class="hljs-string">"glyphicon glyphicon-play"</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Function for starting the animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startAnimation</span><span class="hljs-params">()</span></span>{
  paused = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Change #play-icon elements’ classname to .glypicon-pause to show the play icon when is paused</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"play-icon"</span>).className = <span class="hljs-string">"glyphicon glyphicon-pause"</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>If this function is executed the animation will play or pause dependant on the variable paused</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">togglePause</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">if</span>(paused == <span class="hljs-literal">true</span>){
    startAnimation();
  }<span class="hljs-keyword">else</span>{
    pauseAnimation();
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Toggle pause if id=”play-button” is clicked</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#play-button"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  togglePause();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>If a key is pressed   </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$(<span class="hljs-built_in">document</span>).keypress(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{        
  <span class="hljs-keyword">if</span>(inputDisabled == <span class="hljs-literal">false</span>){             <span class="hljs-comment">// And the input ins not disabled</span>
    <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">String</span>.fromCharCode(e.which)  <span class="hljs-comment">// Create a variable named c (character)</span>
    <span class="hljs-keyword">if</span>(c == <span class="hljs-string">"a"</span>){           <span class="hljs-comment">// If the character pressed is an a is a, trigger the addConnection function</span>
      addConnection();
    }
    <span class="hljs-keyword">if</span>(c == <span class="hljs-string">"d"</span>){           <span class="hljs-comment">// If the character pressed is a d, trigger the deleteConnections function</span>
      deleteConnections();
    }
    <span class="hljs-keyword">if</span> (e.keyCode == <span class="hljs-number">0</span> || e.keyCode == <span class="hljs-number">32</span>) {    <span class="hljs-comment">// If spacebar (e.keyCode == 32) is pressed</span>
      togglePause();                            <span class="hljs-comment">// Pause the animation</span>
    }
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>This function checks if something is being select at the moment, returns false or true</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">somethingSelected</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">var</span> r = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span>(selected.length &gt; <span class="hljs-number">0</span>){
    r = <span class="hljs-literal">true</span>;
  }<span class="hljs-keyword">else</span>{
    r = <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">return</span> r;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>This function clears that selected array or shows an alert which says: “Nothing selected”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deselectAll</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">if</span>(somethingSelected()){
    selected = [];  
  }
  <span class="hljs-keyword">else</span>{
    showAlert(<span class="hljs-string">".alert-info"</span>, <span class="hljs-string">"Nothing selected"</span>);
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>deselectAll() is triggered on the click of #deselect-all</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#deselect-all"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  deselectAll();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Toggle of visibility of the skeleton</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleSkeleton</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">if</span>(skeletonVisible == <span class="hljs-literal">true</span>){                <span class="hljs-comment">// If the skeleton is visible</span>
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;connections.length;i++){        <span class="hljs-comment">// Set them al to invisible</span>
      connections[i].object.visible = <span class="hljs-literal">false</span>;
    }
    skeletonVisible = <span class="hljs-literal">false</span>;                  <span class="hljs-comment">// As the global variable</span>
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"skeleton-icon"</span>).className = <span class="hljs-string">"glyphicon glyphicon-eye-close"</span>;     <span class="hljs-comment">// And change the #skeleton-icons' class to ".glyphicon-eye-close" </span>
  }<span class="hljs-keyword">else</span>{                                      <span class="hljs-comment">// If skeleton is not visible</span>
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;connections.length;i++){        <span class="hljs-comment">// Make all connections visible again</span>
      connections[i].object.visible = <span class="hljs-literal">true</span>;
    }
    skeletonVisible = <span class="hljs-literal">true</span>                    <span class="hljs-comment">// As the global variable</span>
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"skeleton-icon"</span>).className = <span class="hljs-string">"glyphicon glyphicon-eye-open"</span>;      <span class="hljs-comment">// And change the #skeleton-icons' class to ".glyphicon-eye-close" </span>
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p> Trigger toggleSkeleton(); if #toggle-skeleton is being clicked</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#toggle-skeleton"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  toggleSkeleton();
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideSelectedObjects</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;markers.length;i++){
    <span class="hljs-keyword">var</span> s = markers[i].isSelected();
    <span class="hljs-built_in">console</span>.log(s);
    <span class="hljs-keyword">if</span>(s == <span class="hljs-literal">true</span>){
      markers[i].object.visible = <span class="hljs-literal">false</span>;
    }
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showSelectedObjects</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;markers.length;i++){
    markers[i].object.visible = <span class="hljs-literal">true</span>;
  }
}

$( <span class="hljs-string">"#toggle-show-selected"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span>(somethingSelected()){
    <span class="hljs-keyword">if</span>(selectedVisible == <span class="hljs-literal">true</span>){
      hideSelectedObjects();
      selectedVisible = <span class="hljs-literal">false</span>;
      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"selected-toggle-icon"</span>).className = <span class="hljs-string">"glyphicon glyphicon-eye-close"</span>;
    }<span class="hljs-keyword">else</span>{
      showSelectedObjects();
      selectedVisible = <span class="hljs-literal">true</span>
      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"selected-toggle-icon"</span>).className = <span class="hljs-string">"glyphicon glyphicon-eye-open"</span>;
    }
  }
  <span class="hljs-keyword">else</span>{
    showAlert(<span class="hljs-string">".alert-info"</span>, <span class="hljs-string">"Nothing selected"</span>);
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>This function creates a connection if two markers are selected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addConnection</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">if</span>(selected[<span class="hljs-number">0</span>] &amp;&amp; selected[<span class="hljs-number">1</span>]){
    <span class="hljs-keyword">if</span>(selected[<span class="hljs-number">0</span>].type == <span class="hljs-string">"marker"</span> &amp;&amp; selected[<span class="hljs-number">1</span>].type == <span class="hljs-string">"marker"</span>){
      <span class="hljs-keyword">var</span> exists = validConnection(selected[<span class="hljs-number">0</span>].index, selected[<span class="hljs-number">1</span>].index);
      <span class="hljs-keyword">if</span>(!exists){
        <span class="hljs-keyword">var</span> connection = <span class="hljs-keyword">new</span> Connection(selected[<span class="hljs-number">0</span>].index, selected[<span class="hljs-number">1</span>].index);
        connection.draw();
        connections.push(connection);   
      }
    }<span class="hljs-keyword">else</span>{
      showAlert(<span class="hljs-string">".alert-info"</span>, <span class="hljs-string">"Please make sure to select markers and no other objects."</span>);
    }
  }<span class="hljs-keyword">else</span>{
    showAlert(<span class="hljs-string">".alert-info"</span>, <span class="hljs-string">"Please select two markers first."</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validConnection</span><span class="hljs-params">(m1, m2)</span></span>{
  <span class="hljs-keyword">var</span> result;
  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;connections.length;i++){
    <span class="hljs-keyword">if</span>(connections[i].m1 == m1 &amp;&amp; connections[i].m2 == m2){
      result = <span class="hljs-literal">true</span>;
      showAlert(<span class="hljs-string">".alert-info"</span>, <span class="hljs-string">"Connection already exists!"</span>);
    }<span class="hljs-keyword">else</span>{
      result = <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">if</span>(m1 == m2){
    result = <span class="hljs-literal">false</span>;
    showAlert(<span class="hljs-string">".alert-info"</span>, <span class="hljs-string">"Can not connect to same marker."</span>);
  }
  <span class="hljs-keyword">return</span> result;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#add-connection"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  addConnection();
});</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre> $( <span class="hljs-string">"#slowdown-animation"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  animationSpeed = animationSpeed * <span class="hljs-number">0.5</span>;
  $(<span class="hljs-string">'#animation-speed-label'</span>).html(animationSpeed + <span class="hljs-string">" x "</span>);
});</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>   $( <span class="hljs-string">"#speedup-animation"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    animationSpeed = animationSpeed * <span class="hljs-number">2</span>;
    $(<span class="hljs-string">'#animation-speed-label'</span>).html(animationSpeed + <span class="hljs-string">" x "</span>);
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $( <span class="hljs-string">"#delete"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    deleteConnections();
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#selected-smaller"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{

  <span class="hljs-keyword">if</span>(selected[<span class="hljs-number">0</span>].type == <span class="hljs-string">"connection"</span>){
    <span class="hljs-keyword">if</span>(connectionWidth != <span class="hljs-number">0</span>){
      connectionWidth = connectionWidth - <span class="hljs-number">1</span>;  
    }
  }

  <span class="hljs-keyword">if</span>(selected[<span class="hljs-number">0</span>].type == <span class="hljs-string">"marker"</span>){
    markerRadius = markerRadius -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; markers.length; i++){
      markers[i].remove();
      markers[i].draw();
      scene.add(markers[i].object);
    }
  }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#selected-larger"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{

  <span class="hljs-keyword">if</span>(selected[<span class="hljs-number">0</span>].type == <span class="hljs-string">"connection"</span>){
    <span class="hljs-keyword">if</span>( connectionWidth &lt; <span class="hljs-number">10</span> ){
      connectionWidth = connectionWidth + <span class="hljs-number">1</span>;
    }
  }

  <span class="hljs-keyword">if</span>(selected[<span class="hljs-number">0</span>].type == <span class="hljs-string">"marker"</span>){
    <span class="hljs-keyword">if</span>( markerRadius &gt; <span class="hljs-number">0</span> ){
      markerRadius = markerRadius +<span class="hljs-number">1</span>;
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; markers.length; i++){
        markers[i].remove();
        markers[i].draw();
        scene.add(markers[i].object);
      }
    }
  }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Create a connection, to do so, pass selected points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$( <span class="hljs-string">"#reset"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  init(filePath);
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveSkeleton</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">var</span> name = $(<span class="hljs-string">"#skeleton-name"</span>).val();

  <span class="hljs-keyword">var</span> connections_data = {};
  connections_data.title = name;

  <span class="hljs-keyword">var</span> connection_objects = [];

  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;connections.length;i++){
    <span class="hljs-built_in">console</span>.log(connections[i]);
    <span class="hljs-keyword">var</span> marker_1 = connections[i].m1;
    <span class="hljs-keyword">var</span> marker_2 = connections[i].m2;
    <span class="hljs-keyword">var</span> connection = {m1: marker_1, m2: marker_2}; 
    connection_objects.push(connection);
  }

  connections_data.connections = connection_objects;

  <span class="hljs-keyword">var</span> data = <span class="hljs-built_in">JSON</span>.stringify(connections_data);

  $.ajax({
    url: <span class="hljs-string">'save_skeleton.php'</span>,
    type: <span class="hljs-string">'post'</span>,
    data: { <span class="hljs-string">'data'</span>: data, <span class="hljs-string">'title'</span>: name },
    success: savedSkeleton,
    error: errorSavingSkeleton
    }); <span class="hljs-comment">// end ajax call</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">savedSkeleton</span><span class="hljs-params">()</span></span>{
    $(<span class="hljs-string">'#save-skeleton-modal'</span>).modal(<span class="hljs-string">'hide'</span>);
    showAlert(<span class="hljs-string">".alert-success"</span>,<span class="hljs-string">"Skeleton with name: "</span> + name + <span class="hljs-string">" saved succesfully!"</span>);
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorSavingSkeleton</span><span class="hljs-params">(e)</span></span>{
    $(<span class="hljs-string">'#save-skeleton-modal'</span>).modal(<span class="hljs-string">'hide'</span>);
    showAlert(<span class="hljs-string">".alert-error"</span>,e);
  }
}

$( <span class="hljs-string">"#save-skeleton"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">if</span>( $(<span class="hljs-string">"#skeleton-name"</span>).val() ) {
    saveSkeleton();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> alert = <span class="hljs-string">"#enter-name"</span>;
    $(alert).fadeIn();
    $(alert).delay( <span class="hljs-number">1200</span> ).fadeOut();
  }
});

$( <span class="hljs-string">"#show-load-skeleton-modal"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  $.get( <span class="hljs-string">"skeleton_files_list.php"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( data )</span> </span>{
    $(<span class="hljs-string">"#skeleton-files"</span>).html( data );
  });
  $(<span class="hljs-string">'#load-skeleton-modal'</span>).modal(<span class="hljs-string">'show'</span>);
});

$( <span class="hljs-string">"#show-save-skeleton-modal"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">if</span>(connections.length &gt; <span class="hljs-number">0</span>){
    $(<span class="hljs-string">'#save-skeleton-modal'</span>).modal(<span class="hljs-string">'show'</span>);
    pauseAnimation();
  } <span class="hljs-keyword">else</span>{
    showAlert(<span class="hljs-string">".alert-info"</span>,<span class="hljs-string">"Please draw a skeleton first!"</span>)
  }
});

$( <span class="hljs-string">"#show-files-list"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  pauseAnimation();
  $(<span class="hljs-string">'#show-files-modal'</span>).modal(<span class="hljs-string">'show'</span>);
});

$( <span class="hljs-string">"#show-socket-modal"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  controls.enabled = <span class="hljs-literal">false</span>;
  pauseAnimation();
  $(<span class="hljs-string">'#socket-adress-modal'</span>).modal(<span class="hljs-string">'show'</span>);
  $(<span class="hljs-string">'#socket-adress'</span>).focus();
});

$(<span class="hljs-string">"#connect-to-socket"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  $(<span class="hljs-string">'.modal'</span>).find(<span class="hljs-string">'#socket-loader'</span>).show();
  <span class="hljs-keyword">var</span> adress = $(<span class="hljs-string">'#socket-adress'</span>).val();
  <span class="hljs-keyword">var</span> socket = <span class="hljs-keyword">new</span> Socket();
  socket.connect(adress);
  animateFromSocket(adress);
})

$(<span class="hljs-string">"#animate-file"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  animateFromFile(url);
})

$( <span class="hljs-string">".coordinate-file-url"</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  $(<span class="hljs-string">".modal"</span>).modal(<span class="hljs-string">'hide'</span>);
  <span class="hljs-keyword">var</span> url = $(<span class="hljs-keyword">this</span>).text();</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>webglRenderer.context.canvas.loseContext();</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  animateFile(url);
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadSkeleton</span><span class="hljs-params">(url)</span></span>{
  $.getJSON(url, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(json)</span> </span>{
    <span class="hljs-built_in">console</span>.log(json);</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Delete all connections     </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i &lt; connections.length;i++){
      connections[i].remove();
    }

    connections.length = <span class="hljs-number">0</span>;
    selected.length = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;json.connections.length;i++){
      <span class="hljs-keyword">var</span> connection = <span class="hljs-keyword">new</span> Connection(json.connections[i].m1, json.connections[i].m2);
      connection.draw();
      connections.push(connection);
    }
    <span class="hljs-built_in">console</span>.log(connections);
  });
}

$(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">"click"</span>, <span class="hljs-string">".load-skeleton"</span>, 
  <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    $(<span class="hljs-string">".modal"</span>).modal(<span class="hljs-string">'hide'</span>);
    <span class="hljs-keyword">var</span> url = $(<span class="hljs-keyword">this</span>).text();</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>webglRenderer.context.canvas.loseContext();</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    loadSkeleton(url);
  }
  );


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showAlert</span><span class="hljs-params">(alert_class, text)</span></span>{
  $(alert_class).html(text);
  $(alert_class).fadeIn();
  $(alert_class).delay( <span class="hljs-number">1200</span> ).fadeOut();
}



<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onDocumentMouseDown</span><span class="hljs-params">( event )</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  event.preventDefault();</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>get the mouse positions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> mouse_x = ( event.clientX / <span class="hljs-built_in">window</span>.innerWidth ) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> mouse_y = -( event.clientY / <span class="hljs-built_in">window</span>.innerHeight ) * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>;

  <span class="hljs-keyword">var</span> vector = <span class="hljs-keyword">new</span> THREE.Vector3(mouse_x, mouse_y, <span class="hljs-number">0.5</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>we do this by using the unproject function which converts the 2D mouse
position to a 3D vector.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  vector.unproject(camera);</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>now we cast a ray using this vector and see what is hit.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> raycaster = <span class="hljs-keyword">new</span> THREE.Raycaster(camera.position, vector.sub(camera.position).normalize());

  raycaster.linePrecision = connectionWidth;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>intersects contains an array of objects that might have been hit</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> intersects = raycaster.intersectObjects(scene.children);

  <span class="hljs-keyword">var</span> result = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> ( intersects.length &gt; <span class="hljs-number">0</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>If array is not empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span>(selected.length &gt; <span class="hljs-number">0</span>){</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>If clicked item is not similar to selected items, empty array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span>(intersects[<span class="hljs-number">0</span>].object.type != selected[<span class="hljs-number">0</span>].type){
        deselectAll();
      }      
    }
    
    intersected = intersects[<span class="hljs-number">0</span>].object;</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>This variable will behold wether the intersected object was selected or not</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> isSelected = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Check if is in selected array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;selected.length;i++) {</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>If so, remove it </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (selected[i].uuid == intersects[<span class="hljs-number">0</span>].object.uuid){
        isSelected = <span class="hljs-literal">true</span>;
        selected.splice(i, <span class="hljs-number">1</span>);
      }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>If the intersected object was not already selected, select it </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span>(isSelected == <span class="hljs-literal">false</span>){
      selected.push(intersected);  
    }
  }
}

$(<span class="hljs-built_in">document</span>).mousedown(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  onDocumentMouseDown(event, selected);
});</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>This function causes to focus on the first inputfield of every modal that is fired</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$(<span class="hljs-string">'.modal'</span>).on(<span class="hljs-string">'shown.bs.modal'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  inputDisabled = <span class="hljs-literal">true</span>;
  controls.enabled = <span class="hljs-literal">false</span>;
  lastfocus = $(<span class="hljs-keyword">this</span>);
  $(<span class="hljs-keyword">this</span>).find(<span class="hljs-string">'input:text:visible:first'</span>).focus();
  paused = <span class="hljs-literal">true</span>;
})</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>This function causes to enable input when the modal is hidden</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$(<span class="hljs-string">'.modal'</span>).on(<span class="hljs-string">'hidden.bs.modal'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"modal close"</span>);
  inputDisabled = <span class="hljs-literal">false</span>;
  controls.enabled = <span class="hljs-literal">true</span>;
  paused = <span class="hljs-literal">false</span>;
})</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
